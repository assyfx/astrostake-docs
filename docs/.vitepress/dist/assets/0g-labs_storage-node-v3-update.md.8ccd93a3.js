import{_ as s,c as a,o as n,a as l}from"./app.002226a4.js";const A=JSON.parse('{"title":"Storage Node Update V2 to V3","description":"","frontmatter":{},"headers":[{"level":2,"title":"One-Click Command","slug":"one-click-command","link":"#one-click-command","children":[]},{"level":2,"title":"Manual Install","slug":"manual-install","link":"#manual-install","children":[]},{"level":2,"title":"Useful Command","slug":"useful-command","link":"#useful-command","children":[]}],"relativePath":"0g-labs/storage-node-v3-update.md"}'),e={name:"0g-labs/storage-node-v3-update.md"},o=l(`<h1 id="storage-node-update-v2-to-v3" tabindex="-1">Storage Node Update V2 to V3 <a class="header-anchor" href="#storage-node-update-v2-to-v3" aria-hidden="true">#</a></h1><p>This guide will help you set up a Storage Node for OG Labs. For official documentation, check <a href="https://docs.0g.ai/run-a-node/storage-node" target="_blank" rel="noreferrer">here</a>.</p><p>Version: <code>v1.0.0</code></p><h2 id="one-click-command" tabindex="-1">One-Click Command <a class="header-anchor" href="#one-click-command" aria-hidden="true">#</a></h2><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">bash &lt;(wget -qO- https://astrostake.xyz/upgrade_storage_node_v3.sh)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h2 id="manual-install" tabindex="-1">Manual Install <a class="header-anchor" href="#manual-install" aria-hidden="true">#</a></h2><ol><li><strong>Stop Service</strong></li></ol><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">systemctl stop zgs</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><ol start="2"><li><strong>Remove db folder</strong></li></ol><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">rm -rf $HOME/0g-storage-node/run/db</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><ol start="3"><li><strong>Backup Config</strong></li></ol><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">cp $HOME/0g-storage-node/run/config.toml $HOME/zgs-config.toml.backup</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><ol start="4"><li><strong>Update to v1.0.0</strong></li></ol><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">cd $HOME/0g-storage-node</span></span>
<span class="line"><span style="color:#A6ACCD;">git stash</span></span>
<span class="line"><span style="color:#A6ACCD;">git fetch --all --tags</span></span>
<span class="line"><span style="color:#A6ACCD;">git checkout v1.0.0</span></span>
<span class="line"><span style="color:#A6ACCD;">git submodule update --init</span></span>
<span class="line"><span style="color:#A6ACCD;">cargo build --release</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><ol start="5"><li><strong>Download V3 Config</strong></li></ol><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">rm -rf $HOME/0g-storage-node/run/config.toml</span></span>
<span class="line"><span style="color:#A6ACCD;">curl -o $HOME/0g-storage-node/run/config.toml https://vault.astrostake.xyz/0g-labs/config-v3.toml</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>check <code>miner_key</code> and input your private key</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">nano $HOME/0g-storage-node/run/config.toml</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><ol start="6"><li><strong>Delete and Create New Service</strong></li></ol><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">sudo rm -f /etc/systemd/system/zgs.service</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">sudo tee /etc/systemd/system/zgs.service &gt; /dev/null &lt;&lt;EOF</span></span>
<span class="line"><span style="color:#A6ACCD;">[Unit]</span></span>
<span class="line"><span style="color:#A6ACCD;">Description=ZGS Node</span></span>
<span class="line"><span style="color:#A6ACCD;">After=network.target</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">[Service]</span></span>
<span class="line"><span style="color:#A6ACCD;">User=$USER</span></span>
<span class="line"><span style="color:#A6ACCD;">WorkingDirectory=$HOME/0g-storage-node/run</span></span>
<span class="line"><span style="color:#A6ACCD;">ExecStart=$HOME/0g-storage-node/target/release/zgs_node --config $HOME/0g-storage-node/run/config.toml</span></span>
<span class="line"><span style="color:#A6ACCD;">Restart=on-failure</span></span>
<span class="line"><span style="color:#A6ACCD;">RestartSec=10</span></span>
<span class="line"><span style="color:#A6ACCD;">LimitNOFILE=65535</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">[Install]</span></span>
<span class="line"><span style="color:#A6ACCD;">WantedBy=multi-user.target</span></span>
<span class="line"><span style="color:#A6ACCD;">EOF</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><ol start="7"><li><strong>Restart Service</strong></li></ol><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">sudo systemctl daemon-reload &amp;&amp; sudo systemctl enable zgs &amp;&amp; sudo systemctl start zgs</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h2 id="useful-command" tabindex="-1">Useful Command <a class="header-anchor" href="#useful-command" aria-hidden="true">#</a></h2><p>Check full logs</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">tail -f ~/0g-storage-node/run/log/zgs.log.$(TZ=UTC date +%Y-%m-%d)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>Check block &amp; peers</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">source &lt;(curl -s https://astrostake.xyz/check_block.sh)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div>`,28),t=[o];function p(c,r,i,d,C,g){return n(),a("div",null,t)}const y=s(e,[["render",p]]);export{A as __pageData,y as default};
